<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple Polylines</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>


      function initMap() {
        var config = {
            apiKey: "AIzaSyCCSB8kN6eqVVpsSb7_5dN7os9f8YVuEN8",
            authDomain: "testfb-6251e.firebaseapp.com",
            databaseURL: "https://testfb-6251e.firebaseio.com",
            projectId: "testfb-6251e",
            storageBucket: "testfb-6251e.appspot.com",
            messagingSenderId: "300440751235"
        };
        firebase.initializeApp(config);
        var database = firebase.database();
        var data = database.ref("logs/1");

        
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: {lat: 10.853400, lng: 106.757108},
          mapTypeId: 'terrain'
        });
        var flightPlanCoordinates2 = [{lat: 10.853400, lng: 106.757108},{lat: 10.854400, lng: 106.757108}];
        var x = [
          {lat: 10.863400, lng: 106.758108},
          {lat: 10.873400, lng: 106.759108},
          {lat: 10.983400, lng: 106.860108}
        ];
        var flightPath = new google.maps.Polyline({
          path: flightPlanCoordinates2,
          geodesic: true,
          strokeColor: '#FF0000',
          strokeOpacity: 1.0,
          strokeWeight: 2
        });

        flightPath.setMap(map);
        var path;
        var c;
        var d;
        data.on("value",function(snap){
            c = snap.val();
            var arr = Object.values(c);
            d = arr.pop();
            console.log(d);
            path = flightPath.getPath();
            // add new point
            path.push(new google.maps.LatLng(d.lat, d.lng));
            // update the polyline with the updated path
            flightPath.setPath(path);
        });
      }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA1LZU7U-fPMn6RMgupnjYyQ6gADycg_ow&callback=initMap">
    </script>
  </body>
</html>
